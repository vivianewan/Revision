<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz – Influence de l'Église médiévale</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-50 to-rose-100 min-h-screen flex items-center justify-center p-4">
  <div id="root" class="w-full max-w-3xl"></div>

  <script type="text/babel">
    // =============================================
    // QUIZ 30 QUESTIONS + RÉCAP FINAL
    // =============================================

    const questions = [
      {id:1,type:'mc',q:"Quel empereur légalise le christianisme en 313 ?",choices:["Dioclétien","Constantin","Théodose I","Charlemagne"],correct:1},
      {id:2,type:'mc',q:"En 800, le pape couronne…",choices:["Charles Martel","Clovis","Charlemagne","Otton I"],correct:2},
      {id:3,type:'tf',q:"Les croisades ont permis un essor des échanges entre Occident et Orient.",correct:true},
      {id:4,type:'tf',q:"Le style gothique précède toujours le style roman.",correct:false},
      {id:5,type:'fill',q:"En 391, le christianisme devient la religion __________ de l'Empire romain.",answer:"officielle"},
      {id:6,type:'mc',q:"Combien de croisades majeures entre 1095 et 1270 ?",choices:["4","6","8","10"],correct:2},
      {id:7,type:'fill',q:"Le vassal jure fidélité et __________ à son seigneur.",answer:"obéissance"},
      {id:8,type:'tf',q:"Le clergé régulier correspond aux ordres monastiques.",correct:true},
      {id:9,type:'mc',q:"Quel impôt finance l'Église ?",choices:["La taille","La dîme","La gabelle","Le cens"],correct:1},
      {id:10,type:'fill',q:"En 1095, le pape Urbain II prêche la première __________.",answer:"croisade"},
      {id:11,type:'mc',q:"Dans la féodalité, le pouvoir du roi est dit…",choices:["spirituel","temporel","absolu","éphémère"],correct:1},
      {id:12,type:'tf',q:"Les monastères jouent un rôle majeur dans l'éducation.",correct:true},
      {id:13,type:'fill',q:"Deux styles religieux : __________ et gothique.",answer:"roman"},
      {id:14,type:'mc',q:"Quel peuple prend Jérusalem en 1071 ?",choices:["Arabes","Turcs seldjoukides","Mongols","Croisés"],correct:1},
      {id:15,type:'tf',q:"La dîme est due au seigneur laïc.",correct:false},
      {id:16,type:'fill',q:"Lieu de pèlerinage majeur en Espagne : __________.",answer:"Compostelle"},
      {id:17,type:'mc',q:"Qui dirige un diocèse ?",choices:["Prêtre","Abbesse","Évêque","Cardinal"],correct:2},
      {id:18,type:'tf',q:"Le pape possède un pouvoir temporel direct sur tous les royaumes.",correct:false},
      {id:19,type:'fill',q:"Le château fort protège la __________ en cas d'attaque.",answer:"population"},
      {id:20,type:'mc',q:"Le serment d'un vassal inclut :",choices:["Payer la dîme","Servir militairement","Construire une cathédrale","Prêcher"],correct:1},
      {id:21,type:'tf',q:"Les arts médiévaux sont souvent au service de l'enseignement religieux.",correct:true},
      {id:22,type:'fill',q:"La messe dominicale rythme la __________ des fidèles.",answer:"semaine"},
      {id:23,type:'mc',q:"Quelle valeur n'est PAS mise en avant chez les moines ?",choices:["Charité","Sacrifice","Opulence","Pauvreté"],correct:2},
      {id:24,type:'tf',q:"La chute de Rome affaiblit immédiatement l'influence de l'Église.",correct:false},
      {id:25,type:'fill',q:"Les seigneurs octroient des __________ à leurs vassaux.",answer:"fiefs"},
      {id:26,type:'mc',q:"Quel pouvoir possède le pape ?",choices:["Spirituel","Temporel","Judiciaire laïque","Fiscal"],correct:0},
      {id:27,type:'tf',q:"Les paysans doivent accomplir des corvées pour le seigneur.",correct:true},
      {id:28,type:'fill',q:"Les __________ seldjoukides occupent Jérusalem en 1071.",answer:"Turcs"},
      {id:29,type:'mc',q:"Quel sacrement marque l'entrée dans la vie chrétienne ?",choices:["Baptême","Mariage","Confirmation","Eucharistie"],correct:0},
      {id:30,type:'tf',q:"Le latin reste la langue liturgique pendant tout le Moyen Âge.",correct:true}
    ];

    // ========== Composant principal ==========
    function QuizApp(){
      const [phase,setPhase]   = React.useState(0); // 0 intro, 1 questions, 2 récap
      const [index,setIndex]   = React.useState(0);
      const [score,setScore]   = React.useState(0);
      const [answers,setAns]   = React.useState([]); // {q,user,correct,isCorrect}

      const q = questions[index];

      const handleNext = (good,userResp) => {
        const correctText = q.type==='mc' ? q.choices[q.correct] : (q.type==='tf' ? (q.correct? 'Vrai':'Faux') : q.answer);
        setAns(a=>[...a,{q:q.q,user:userResp||'—',correct:correctText,isCorrect:good}]);
        if(good) setScore(s=>s+1);
        if(index+1 < questions.length) setIndex(i=>i+1); else setPhase(2);
      };

      if(phase===0) return <Intro start={()=>setPhase(1)} />;
      if(phase===2) return <Recap data={answers} score={score} restart={()=>{setPhase(1);setIndex(0);setScore(0);setAns([]);}} />;
      return <QuestionCard q={q} idx={index} total={questions.length} next={handleNext} />;
    }

    // ========== Intro ==========
    const Intro = ({start}) => (
      <div className="bg-white/80 p-8 rounded-2xl shadow-lg text-center space-y-4">
        <h1 className="text-2xl font-bold">Quiz – Influence de l'Église médiévale</h1>
        <p>{questions.length} questions auto‑corrigées + récapitulatif final.</p>
        <button onClick={start} className="bg-indigo-600 text-white px-4 py-2 rounded-xl">Commencer</button>
      </div>
    );

    // ========== Question ==========
    function QuestionCard({q,idx,total,next}){
      const [val,setVal] = React.useState("");
      const answerFill = () => next(val.trim().toLowerCase()===q.answer.toLowerCase(),val);

      return (
        <div className="bg-white/80 p-8 rounded-2xl shadow-lg space-y-6">
          <div className="text-sm text-right">Question {idx+1}/{total}</div>
          <h2 className="text-lg font-semibold whitespace-pre-wrap">{q.q}</h2>

          {q.type==='mc' && q.choices.map((c,i)=>(
            <button key={i} onClick={()=>next(i===q.correct,c)} className="w-full text-left border rounded-lg px-4 py-2 hover:bg-indigo-100">{String.fromCharCode(97+i)}) {c}</button>
          ))}

          {q.type==='tf' && (
            <div className="flex gap-3 justify-center">
              <button onClick={()=>next(q.correct===true,'Vrai')} className="bg-green-600 text-white px-6 py-2 rounded-xl">Vrai</button>
              <button onClick={()=>next(q.correct===false,'Faux')} className="bg-red-600 text-white px-6 py-2 rounded-xl">Faux</button>
            </div>
          )}

          {q.type==='fill' && (
            <div className="flex flex-col items-center gap-3">
              <input value={val} onChange={e=>setVal(e.target.value)} className="border px-4 py-2 rounded-lg w-64 text-center" placeholder="Votre réponse" />
              <button onClick={answerFill} className="bg-indigo-600 text-white px-4 py-2 rounded-xl">Valider</button>
            </div>
          )}
        </div>
      );
    }

    // ========== Récap ==========
    function Recap({data,score,restart}){
      return (
        <div className="bg-white/80 p-8 rounded-2xl shadow-lg w-full max-h-[90vh] overflow-auto space-y-4">
          <h2 className="text-2xl font-bold text-center">Récapitulatif</h2>
          <p className="text-center text-xl mb-4">Score : {score} / {data.length}</p>
          <table className="w-full text-sm border">
            <thead className="bg-slate-200 sticky top-0">
              <tr>
                <th className="p-2 border">#</th>
                <th className="p-2 border text-left">Question</th>
                <th className="p-2 border"">Ta réponse</th>
                <th className="p-2 border">Bonne réponse</th>
                <th className="p-2 border">✓</th>
              </tr>
            </thead>
            <tbody>
              {data.map((a,i)=>(
                <tr key={i} className={a.isCorrect? 'bg-green-50':'bg-red-50'}>
                  <td className="border p-1 text-center">{i+1}</td>
                  <td className="border p-1 whitespace-pre-wrap">{a.q}</td>
                  <td className="border p-1 text-center">{a.user}</td>
                  <td className="border p-1 text-center">{a.correct}</td>
                  <td className="border p-1 text-center">{a.isCorrect?'✓':'✗'}</td>
                </tr>
              ))}
            </tbody>
          </table>
          <button onClick={restart} className="block mx-auto mt-6 bg-green-600 text-white px-4 py-2 rounded-xl">Rejouer</
